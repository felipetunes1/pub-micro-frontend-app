<div class="container">
   <app-go-home [title]="title + ' Dispatcher'"></app-go-home>
   <div class="row" style="margin-top: 30px;" *ngIf="!create">
      <div class="col-sm-12">
         <mat-form-field style="width: 100%">
            <mat-label>Template Code</mat-label>
            <input matInput type="text" [(ngModel)]="templateCode" name="templateCode" disabled="!details" />
         </mat-form-field>
      </div>
   </div>
   <mat-vertical-stepper [linear]="create">
      <mat-step [stepControl]="initialFormGroup">
         <form [formGroup]="initialFormGroup" class="codeMirrorUrl" style="padding: 20px 0px">
            <ng-template matStepLabel>Initial Config <mat-icon *ngIf="initialFormGroup.valid">check</mat-icon>
            </ng-template>
            <div class="row">
               <div class="col-sm-6">
                  <mat-form-field>
                     <mat-label>Method</mat-label>
                     <mat-select formControlName="method">
                        <mat-option>Clear</mat-option>
                        <mat-option value="GET">GET</mat-option>
                        <mat-option value="POST">POST</mat-option>
                        <mat-option value="PUT">PUT</mat-option>
                        <mat-option value="PATCH" disabled="!showXml">PATCH</mat-option>
                        <mat-option value="DELETE">DELETE</mat-option>
                     </mat-select>
                     <mat-error *ngIf="initialFormGroup.controls.method.errors">
                        <span *ngIf="initialFormGroup.controls.method.errors.required">Internal URL is
                           Required</span>
                     </mat-error>
                  </mat-form-field>
               </div>
               <div class="col-sm-6">
                  <mat-checkbox formControlName="oldVersion">Old Version</mat-checkbox>
               </div>
            </div>
            <div class="row" style="margin-top: 30px;">
               <div class="col-sm-12">
                  <mat-label>Internal URL*</mat-label>
                  <ngx-codemirror formControlName="internalUrl" [options]="{
                        theme: 'idea',
                        mode: 'javascript',
                        gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter', 'CodeMirror-lint-markers', 'CodeMirror'],
                        readOnly: (!details ? false : 'nocursor'),
                        lineNumbers: true,
                        lineWrapping: true,
                        foldGutter: true,
                        autoCloseBrackets: true,
                        matchBrackets: true,
                        lint: true
                     }"></ngx-codemirror>
                  <mat-error *ngIf="initialFormGroup.controls.internalUrl.errors">
                     <span *ngIf="initialFormGroup.controls.internalUrl.errors.required">Internal URL is
                        Required</span>
                  </mat-error>
               </div>
            </div>
            <div class="row" style="margin-top: 30px;">
               <div class="col-sm-12">
                  <mat-label>External URL</mat-label>
                  <ngx-codemirror formControlName="externalUrl" [options]="{
                        theme: 'idea',
                        mode: 'javascript',
                        gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter', 'CodeMirror-lint-markers', 'CodeMirror'],
                        readOnly: (showXml && !details ? false : 'nocursor'),
                        lineNumbers: true,
                        lineWrapping: true,
                        foldGutter: true,
                        autoCloseBrackets: true,
                        matchBrackets: true,
                        lint: true
                     }"></ngx-codemirror>
               </div>
            </div>
            <div class="row" style="text-align: right; margin-top: 30px;" *ngIf="!details">
               <div class="col-sm-12">
                  <button mat-raised-button matStepperNext color="primary">Next</button>
               </div>
            </div>
         </form>
      </mat-step>
      <mat-step [stepControl]="requestHeaderFormGroup" optional>
         <form [formGroup]="requestHeaderFormGroup">
            <ng-template matStepLabel>Header Request Template <mat-icon *ngIf="requestHeaderFormGroup.valid">check
               </mat-icon>
            </ng-template>
            <div class="row">
               <div class="col-sm-12">
                  <ngx-codemirror formControlName="headerInput" [options]="{
                     theme: 'idea',
                     mode: 'javascript',
                     gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter', 'CodeMirror-lint-markers', 'CodeMirror'],
                     readOnly: (!details ? false : 'nocursor'),
                     lineNumbers: true,
                     lineWrapping: true,
                     foldGutter: true,
                     autoCloseBrackets: true,
                     matchBrackets: true,
                     lint: true
                  }"></ngx-codemirror>
               </div>
            </div>
            <div class="row" style="text-align: right; margin-top: 30px;" *ngIf="!details">
               <div class="col-sm-12">
                  <button mat-raised-button matStepperNext color="primary">Next</button>
               </div>
            </div>
         </form>
      </mat-step>
      <mat-step [stepControl]="requestBodyFormGroup">
         <form [formGroup]="requestBodyFormGroup">
            <ng-template matStepLabel>Body Request Template <mat-icon *ngIf="requestBodyFormGroup.valid">check
               </mat-icon>
            </ng-template>
            <ngx-codemirror formControlName="bodyInput" [options]="{
               theme: 'idea',
               mode: 'javascript',
               gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter', 'CodeMirror-lint-markers', 'CodeMirror'],
               readOnly: (!details ? false : 'nocursor'),
               lineNumbers: true,
               lineWrapping: true,
               foldGutter: true,
               autoCloseBrackets: true,
               matchBrackets: true,
               lint: true
            }"></ngx-codemirror>
            <div class="row" style="text-align: right; margin-top: 30px;" *ngIf="!details">
               <div class="col-sm-12">
                  <button mat-raised-button matStepperNext color="primary">Next</button>
               </div>
            </div>
         </form>
      </mat-step>
      <mat-step [stepControl]="xmlFormGroup" optional *ngIf="showXml">
         <form [formGroup]="xmlFormGroup">
            <ng-template matStepLabel>SOAP Config <mat-icon *ngIf="xmlFormGroup.valid">check</mat-icon>
            </ng-template>
            <div class="row" style="margin-top: 30px;">
               <div class="col-sm-6">
                  <mat-form-field>
                     <mat-label>Envelope CDATA</mat-label>
                     <input matInput type="text" formControlName="cdataEnvelope" />
                  </mat-form-field>
               </div>
               <div class="col-sm-6">
                  <mat-checkbox formControlName="removeAddAttribute">Remove Others Requests Attributes</mat-checkbox>
               </div>
            </div>
            <div class="row" style="margin-top: 30px;">
               <div class="col-sm-6">
                  <mat-form-field>
                     <mat-label>Extract CDATA</mat-label>
                     <input matInput type="text" formControlName="cdataInsertion" />
                  </mat-form-field>
               </div>
               <div class="col-sm-6">
                  <mat-checkbox formControlName="responseWithAttribute">Response With Attributes</mat-checkbox>
               </div>
            </div>
            <div class="row" style="margin-top: 30px;">
               <div class="col-sm-12">
                  <mat-label>XML Body Response Template</mat-label>
                  <ngx-codemirror formControlName="bodyOutXml" [options]="{
                     theme: 'idea',
                     mode: 'javascript',
                     gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter', 'CodeMirror-lint-markers', 'CodeMirror'],
                     readOnly: (!details ? false : 'nocursor'),
                     lineNumbers: true,
                     lineWrapping: true,
                     foldGutter: true,
                     autoCloseBrackets: true,
                     matchBrackets: true,
                     lint: true
                  }"></ngx-codemirror>
               </div>
            </div>
            <div class="row" style="text-align: right; margin-top: 30px;" *ngIf="!details">
               <div class="col-sm-12">
                  <button mat-raised-button matStepperNext color="primary">Next</button>
               </div>
            </div>
         </form>
      </mat-step>
      <mat-step [stepControl]="responseHeaderFormGroup" optional>
         <form [formGroup]="responseHeaderFormGroup">
            <ng-template matStepLabel>Header Response Template <mat-icon *ngIf="responseHeaderFormGroup.valid">check
               </mat-icon>
            </ng-template>
            <div class="row">
               <div class="col-sm-12">
                  <ngx-codemirror formControlName="headerOutput" [options]="{
                     theme: 'idea',
                     mode: 'javascript',
                     gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter', 'CodeMirror-lint-markers', 'CodeMirror'],
                     readOnly: (!details ? false : 'nocursor'),
                     lineNumbers: true,
                     lineWrapping: true,
                     foldGutter: true,
                     autoCloseBrackets: true,
                     matchBrackets: true,
                     lint: true
                  }"></ngx-codemirror>
               </div>
            </div>
            <div class="row" style="text-align: right; margin-top: 30px;" *ngIf="!details">
               <div class="col-sm-12">
                  <button mat-raised-button matStepperNext color="primary">Next</button>
               </div>
            </div>
         </form>
      </mat-step>
      <mat-step [stepControl]="responseBodyFormGroup">
         <form [formGroup]="responseBodyFormGroup">
            <ng-template matStepLabel>Body Response Template <mat-icon *ngIf="responseBodyFormGroup.valid">check
               </mat-icon>
            </ng-template>
            <ngx-codemirror formControlName="bodyOutput" [options]="{
               theme: 'idea',
               mode: 'javascript',
               gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter', 'CodeMirror-lint-markers', 'CodeMirror'],
               readOnly: (!details ? false : 'nocursor'),
               lineNumbers: true,
               lineWrapping: true,
               foldGutter: true,
               autoCloseBrackets: true,
               matchBrackets: true,
               lint: true
            }"></ngx-codemirror>
            <div class="row" style="text-align: right; margin-top: 30px;" *ngIf="!details">
               <div class="col-sm-12">
                  <button mat-raised-button matStepperNext color="primary">Next</button>
               </div>
            </div>
         </form>
      </mat-step>
      <mat-step [stepControl]="errorHeaderFormGroup" optional>
         <form [formGroup]="errorHeaderFormGroup">
            <ng-template matStepLabel>Header Error Template <mat-icon *ngIf="errorHeaderFormGroup.valid">check
               </mat-icon>
            </ng-template>
            <div class="row">
               <div class="col-sm-12">
                  <ngx-codemirror formControlName="headerError" [options]="{
                     theme: 'idea',
                     mode: 'javascript',
                     gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter', 'CodeMirror-lint-markers', 'CodeMirror'],
                     readOnly: (!details ? false : 'nocursor'),
                     lineNumbers: true,
                     lineWrapping: true,
                     foldGutter: true,
                     autoCloseBrackets: true,
                     matchBrackets: true,
                     lint: true
                  }"></ngx-codemirror>
               </div>
            </div>
            <div class="row" style="text-align: right; margin-top: 30px;" *ngIf="!details">
               <div class="col-sm-12">
                  <button mat-raised-button matStepperNext color="primary">Next</button>
               </div>
            </div>
         </form>
      </mat-step>
      <mat-step [stepControl]="errorBodyFormGroup">
         <form [formGroup]="errorBodyFormGroup">
            <ng-template matStepLabel>Body Error Template <mat-icon *ngIf="errorBodyFormGroup.valid">check</mat-icon>
            </ng-template>
            <ngx-codemirror formControlName="bodyError" [options]="{
               theme: 'idea',
               mode: 'javascript',
               gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter', 'CodeMirror-lint-markers', 'CodeMirror'],
               readOnly: (!details ? false : 'nocursor'),
               lineNumbers: true,
               lineWrapping: true,
               foldGutter: true,
               autoCloseBrackets: true,
               matchBrackets: true,
               lint: true
            }"></ngx-codemirror>
            <div class="row" style="text-align: right; margin-top: 30px;" *ngIf="!details">
               <div class="col-sm-12">
                  <button mat-raised-button matStepperNext color="primary">Next</button>
               </div>
            </div>
         </form>
      </mat-step>
      <mat-step *ngIf="!details">
         <ng-template matStepLabel>Done</ng-template>
         <p>You are now done.</p>
         <div class="row" style="text-align: right; margin-top: 30px;">
            <div class="col-sm-12">
               <button mat-raised-button color="primary" (click)="submit()">Submit</button>
            </div>
         </div>
      </mat-step>
   </mat-vertical-stepper>
</div>